<html>
  <head>
    <script type="module">
      import jsFunc from "../dist/dotheworm.iife.js?raw";
      // URI-encode only a subset of characters. Most user agents are permissive with
      // non-reserved characters, so don't obfuscate more than we have to.
      const specialCharacters = [
        "%",
        '"',
        "<",
        ">",
        "#",
        "@",
        " ",
        "\\&",
        "\\?",
      ];

      const urlencode = (code) =>
        code.replace(
          new RegExp(specialCharacters.join("|"), "g"),
          encodeURIComponent
        );
      const prefix = (code) => `javascript:${code}`;
      const thingToCopy = prefix(urlencode(jsFunc));
      document.body.append(thingToCopy);
    </script>
    <title>Worm Chart Bookmarklet</title>
  </head>
  <body></body>
</html>
